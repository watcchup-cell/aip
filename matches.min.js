document.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("matches-container");e.innerHTML=`<div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:10px;"><h2 style="color:#2196F3;text-align:center;">📅 مباريات اليوم</h2><button id="toggleThemeBtn" style="background:#333;color:#fff;font-size:20px;border:none;width:40px;height:40px;border-radius:50%;cursor:pointer;">🌙</button></div><div id="matches-list" style="display:grid;gap:15px;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));"></div><div id="copyAlert">✅ تم نسخ الكود بنجاح!</div>`;const t=document.getElementById("toggleThemeBtn");t.addEventListener("click",()=>{document.body.classList.toggle("dark-mode"),t.innerHTML=document.body.classList.contains("dark-mode")?"&#9728;&#65039;":"🌙"}),loadMatches()});async function loadMatches(){const e=new Date().toISOString().slice(0,10),t=`https://ws.kora-api.top/api/matches/${e}`,n=document.getElementById("matches-list");try{const e=await fetch(t);if(!e.ok)throw new Error("فشل الاتصال بالـ API");const a=await e.json();if(n.innerHTML="",!a||0===a.length)return void(n.innerHTML="<p style='text-align:center;'>لا توجد مباريات اليوم.</p>");a.forEach(e=>{const t=`https://ws.kora-api.top/uploads/team/${e.home_logo}`,a=`https://ws.kora-api.top/uploads/team/${e.away_logo}`,o=document.createElement("div");o.className="match-card",o.innerHTML=`<h3>${e.league||"بطولة غير معروفة"}</h3><div style="display:flex;justify-content:space-around;align-items:center;margin:10px 0;"><div style="text-align:center;"><img src="${t}" alt="${e.home}" style="width:45px;height:45px;border-radius:50%;"><br><strong>${e.home}</strong></div><div style="font-size:15px;"><div style="font-weight:bold;color:#2196F3;">${null!=e.home_score?e.home_score:"0"} - ${null!=e.away_score?e.away_score:"0"}</div><div>${e.time||"—"}</div></div><div style="text-align:center;"><img src="${a}" alt="${e.away}" style="width:45px;height:45px;border-radius:50%;"><br><strong>${e.away}</strong></div></div><button class="show-code-btn">عرض الكود</button><div class="code-box"><label>🔗 أدخل رابط المقال:</label><input type="text" class="postLinkInput" placeholder="https://www.yallabox.online/post.html"><textarea style="width:100%;height:200px;font-size:13px;direction:ltr;"></textarea><button class="copy-btn">نسخ الكود</button></div>`;const d=o.querySelector(".show-code-btn");d.addEventListener("click",()=>showCode(o,e,t,a)),n.appendChild(o)})}catch(e){n.innerHTML=`<p style="color:red;text-align:center;">${e.message}</p>`}}function showCode(e,t,n,a){const o=e.querySelector(".code-box"),d=o.querySelector("textarea"),c=o.querySelector(".copy-btn"),i=o.querySelector(".postLinkInput");document.querySelectorAll(".code-box.show").forEach(e=>e.classList.remove("show")),o.classList.toggle("show");const r=i.value.trim()||"https://www.yallabox.online/",l=new Date,s=`${l.toISOString().split("T")[0]}T${t.time||"21:00"}:00+03:00",m=`${l.toISOString().split("T")[0]}T${t.time||"23:00"}:00+03:00",p="count-"+Math.random().toString(36).substring(2,8),x=`<div class="containerMatch"><a href="${r}" ttitle="${t.home} VS ${t.away}"><div class="Match"><div class="fareq"><img src="${n}" width="70"><div class="asm">${t.home}</div></div><div class="Nateja"><div class="matchHour" id="${p}">يتم التحميل...</div><div class="natej">${null!=t.home_score?t.home_score:"0"} - ${null!=t.away_score?t.away_score:"0"}</div></div><div class="fareq"><img src="${a}" width="70"><div class="asm">${t.away}</div></div></div></a></div><script>(function(){const el=document.getElementById("${p}");const s=new Date("${s}");const e=new Date("${m}");function t(){const n=new Date();if(n>=e){el.textContent="انتهت";el.style.color="#f44336";return}if(n>=s){el.textContent="جارية الآن";el.style.color="#4CAF50";setTimeout(t,1e3);return}const a=s-n,o=Math.floor(a/36e5),d=Math.floor(a%36e5/6e4),c=Math.floor(a%6e4/1e3);el.textContent="تبدأ بعد "+(o>0?o+" س ":"")+d+" د "+c+" ث";el.style.color="#2196F3";setTimeout(t,1e3)}t()})();<\/script>`;d.value=x,c.onclick=()=>{navigator.clipboard.writeText(x),document.getElementById("copyAlert").style.display="block",setTimeout(()=>document.getElementById("copyAlert").style.display="none",2e3),o.classList.remove("show")}}
